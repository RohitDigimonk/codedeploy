{% extends 'admin/dashboard-template.html' %}
{% block content %}
{% load static %}


            <div class="container-fluid text-white">
               <div class="row p-t-b-10 ">
                  <div class="col">
                     <h1>Manage Import Data</h1>
                  </div>
               </div>
            </div>
         </header>
         <div class="container-fluid">
           
            <div class="row p-t-b-20">
                  <div class="col-md-12">
                     {% if messages %}
                   {% for message in messages %}
                     {% if message.level == DEFAULT_MESSAGE_LEVELS.INFO %}
                    <div class="alert alert-success alert-dismissible">
                      <a href="#" class="close" data-dismiss="alert" aria-label="close" style="color: crimson!important">&times;</a>
                      <strong>{{message}}</strong> 
                    </div>
                       {% endif %}

                   {% if message.level == DEFAULT_MESSAGE_LEVELS.ERROR %}
                    <div class="alert alert-danger alert-dismissible">
                      <a href="#" class="close" data-dismiss="alert" aria-label="close" style="color: crimson!important">&times;</a>
                      <strong>{{message}}</strong>
                    </div>
                       {% endif %}

                   {% endfor %}
               {% endif %}
                  <div class="login-form-card">
                        <form action="javascript:(0);">
                  <div class="table-responsive">
              <button class="import-data export_data_btn_modal"  data-toggle="modal" data-target="#modal-default1">Import</button>
                                     <!-- start Table  example-->
                                     <!-- <table id="" width="100%" border="1" class="table table-striped table-bordered newpage" align="center" cellpadding="0" cellspacing="0" style=" font-size: 15px;">
                  <thead>
                      <tr>
                          <th align="left" valign="top">Target Backlog Id</th>
                          <th align="left" valign="top">Story Type</th>
                          <th align="left" valign="top">Title</th>
                          <th align="left" valign="top">Story Tri Part Text</th>
                          <th align="left" valign="top">Acceptance Criteria</th>
                          <th align="left" valign="top">Conversation</th>
                          <th align="left" valign="top">Epic Capability</th>
                          <th align="left" valign="top">Feature</th>
                          <th align="left" valign="top">Iteration</th>
                          <th align="left" valign="top">Product</th>
                          <th align="left" valign="top">Team</th>
                          <th align="left" valign="top">Userstory Status</th>
                          <th align="left" valign="top">Owner</th>
                      </tr>
                  </thead>
                  <tbody>
                      <tr>
                          <td align="left" valign="top">Optional</td>
                          <td align="left" valign="top">Optional</td>
                          <td align="left" valign="top">Required</td>
                          <td align="left" valign="top">Required</td>
                          <td align="left" valign="top">Required</td>
                          <td align="left" valign="top">Required</td>
                          <td align="left" valign="top">Optional</td>
                          <td align="left" valign="top">Optional</td>
                          <td align="left" valign="top">Optional</td>
                          <td align="left" valign="top">Optional</td>
                          <td align="left" valign="top">Optional</td>
                          <td align="left" valign="top">Optional</td>
                          <td align="left" valign="top">Current User</td>
                      </tr>
                      <tr>
                          <td align="left" valign="top">Optional</td>
                          <td align="left" valign="top">Optional</td>
                          <td align="left" valign="top">Required</td>
                          <td align="left" valign="top">Required</td>
                          <td align="left" valign="top">Required</td>
                          <td align="left" valign="top">Required</td>
                          <td align="left" valign="top">Optional</td>
                          <td align="left" valign="top">Optional</td>
                          <td align="left" valign="top">Optional</td>
                          <td align="left" valign="top">Optional</td>
                          <td align="left" valign="top">Optional</td>
                          <td align="left" valign="top">Optional</td>
                          <td align="left" valign="top">Current User</td>
                      </tr>
                      
                  </tbody>
                     </table> -->
                                     <!---Table Ends---->
                            </div>
                                    
                         </form>
                      <!-- </div> -->
                    </div>
                    <!-- </div> -->
                  </div>
            </div>
           


          <div class="row p-t-b-20">
                  <div class="col-md-12">
                  <div class="login-form-card">
                        <form action="javascript:(0);">
                  <div class="table-responsive">
                 <h5 style="float: left;"><b>Import History</b></h5>
                                     <!-- start Table -->
                                     <table id="example" width="100%" border="1" class="table table-striped table-bordered newpage" align="center" cellpadding="0" cellspacing="0" style=" font-size: 15px;">
                  <thead>
                      <tr>
                          <th align="left" valign="top">Date/Time </th>
                          <th align="left" valign="top">User</th>
                          <th align="left" valign="top">Import Filename</th>
                          <th align="left" valign="top">Result</th>
                          <th align="left" valign="top">Error Log</th>
                          
                      </tr>
                  </thead>
                  <tbody>
                    {% if get_data|length > 0 %}

                    {% for item in get_data %}
                      <tr>
                          <td align="left" valign="top">{{item.created_date}}</td>
                          <td align="left" valign="top">{{item.created_by.user_name}}</td>
                          <td align="left" valign="top">{{item.file_name}}</td>
                          <td align="left" valign="top">
                        
                            {% get_string_to_table item.file_data %}
                           <!--  <table width="100%" border="0" align="left" cellpadding="0" cellspacing="0">
                               <tr>
                                <td align="center" valign="top">10 User Stories added to ABC Backlog </td>
                               </tr>
                               <td align="center" valign="top">15 User Stories added to ABC Iteration </td>
                               </tr>
                               <td align="center" valign="top">12 User Stories added to ABC Product </td>
                               </tr>
                            </table> -->
                          </td>
                          <td align="left" valign="top">
                            <a target="_blank" href="{{BASE_URL}}media{{item.error_log}}" class="btn btn-default">Show Error Log</a>
                           
                          </td>
                      </tr>
                      {% endfor %}
                      {% endif %}
                      
                  </tbody>
                     </table>
                                     <!---Table Ends---->
                            </div>
                                    
                         </form>
                      <!-- </div> -->
                    </div>
                    <!-- </div> -->
                  </div>
            </div>



         </div>
      </div>
   </div>
</div>

<!-----------2nd Modal Popup Start------>
<div class="modal fade in sp-map" id="modal-default1">
   <div class="modal-dialog">
      <div class="modal-content" style="width: 150%!important;">
         <div class="modal-header">
            <h4 class="modal-title">Import data</h4>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true" style="font-size: 32px;">Ã—</span></button>
         </div>

         

                   {% if import_data_status %}
          
         <div class="modal-body">
            <div class="paper">
              <div class="row">
                <div class="col-md-12" id="show_errors"></div>
              </div>
               <div class="row">
              <div class="col-md-10 offset-md-1" style="border: 2px solid #c52241;">
              <h5><strong>Note:</strong></h5>
              <p>Import file format must be of type .CSV</p>
              <p>Required-Import data in column must contain text.</p>
              <p>Optional-Import data in column may or may not contain text. if import data in column  contains text and the  text does not match a pre-existing value in system the  field  will be set to UNDEFINED upon import</p>
            </div>
          </div>
               <div class="row" id="show_hide_button">

                 <div class="col-md-1"></div>

                 <div class="col-md-10">
  <form onsubmit="doSomething();" action="{{BASE_URL}}data-exchange/add-csv-files"  method="POST"  enctype="multipart/form-data">
                              {% csrf_token %}
                              <input type="hidden" name="modal_name" id="csv_for" value="">
                              <input type="hidden" name="return_url" id="redirect_to" value="">
                              <label>Select CSV File</label>
                              <div class="input-group mb-3">
                                 <input type="file" name="files" multiple="true" class="form-control" id="id_files">
                                 <br>
                                 <div class="input-group-append mt-15" >
                                    <button type="submit" class="btn btn-danger ">Submit</button>
                                 </div>
                              </div>
                           </form>
                        </div>


                 <!-- <div class="col-md-4">

                                <div class="form-group">
                                        <label>Data import as CSV file</label>
                                        {{ImportFilesDataFormUse.files}}         
                                </div> -->
 <!-- <button type="button" class="btn btn-import1 import_data_btn" data-file_type="CSV"><i class="icon-download"></i> Data import as CSV file </button> -->
                 <!-- </div> -->
<!--                  <div class="col-md-4">
                   
                   <button type="button" class="btn btn-import2 import_data_btn" data-file_type="xlsx"><i class="icon-download"></i> Data import as Xlsx file</button>
                 </div> -->
               </div>
            </div>
         </div>

                           {% else %}

                         <div class="alert alert-danger">
                     <strong>Warning!</strong> You are not authorized person.
         </div>
                        {% endif %}
          
              <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
      </div>
   </div>
</div>


{% endblock %}


